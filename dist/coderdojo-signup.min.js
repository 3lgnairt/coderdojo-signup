angular.module("coderdojo-signup",["ui.router","ui.bootstrap","ui.bootstrap.tpls"]),function(){function e(e,t,o){}angular.module("coderdojo-signup").controller("AcceptController",e),e.$inject=["$scope","$rootScope","$state"]}(),function(){function e(e,t){function o(){console.log("Spots",s.spotsLeft);var e={firstName:"",lastName:"",birthday:new Date(2008,9,5),under12:!1,activities:[{name:"Scratch",selected:!1},{name:"Edison Robots",selected:!1},{name:"LEGO Mindstorm Robots",selected:!1},{name:"Website Development",selected:!1},{name:"Other",selected:!1}]};s.form.ninjas.length>=s.spotsLeft?alert("Unfortunately there are only "+s.spotsLeft+" spots left for this event. Therefore, you cannot register more than "+s.spotsLeft+" ninjas at this time. Please contact your local CoderDojo champion if you have any questions"):s.form.ninjas.push(e)}function r(e){var t=s.form.ninjas.indexOf(e);t>=0&&s.form.ninjas.splice(t,1)}function n(e){var t=new Date(2003,9,5),o=Math.abs(t-e.birthday);return 0>o}function a(){function o(e){console.log("submit form success",e),t.go("accept")}function r(e){console.log("submit form err",e),t.go("error")}if(confirm("Is all the information correct? You will not be able to go back and edit it.")){console.log(s.form);for(var a=0;a<s.form.ninjas.length;a++)s.form.ninjas[a].under12=n(s.form.ninjas[a]);var i={method:"POST",url:"/api/registerNinja",header:{"Content-Type":"application/json"},data:{form:s.form,code:s.code}};e(i).then(o,r)}}var s=this;s.auth=t.params.auth,s.code=t.params.code,s.isBw=t.params.code.indexOf("bw")>=0,s.spotsLeft=t.params.spotsLeft,s.auth||(console.log("vm.auth not true"),t.go("register")),s.minDate=new Date(1998,9,5),s.maxDate=new Date(2008,9,5),s.form={ninjas:[{firstName:"",lastName:"",birthday:new Date(2008,9,5),under12:!1,activities:[{name:"Scratch",selected:!1},{name:"Edison Robots",selected:!1},{name:"LEGO Mindstorm Robots",selected:!1},{name:"Website Development",selected:!1},{name:"Other",selected:!1}]}],dojo:s.isBw?"Bankwest":"",bwContact:{firstName:"",lastName:""},parent:{firstName:"",lastName:"",email:"",phone:""},photoPermission:!1,comments:""},s.add=o,s.remove=r,s.register=a}angular.module("coderdojo-signup").controller("FormController",e),e.$inject=["$http","$state"]}(),function(){function e(e,t){function o(){function o(e){console.log(e);var o={code:e.data.code,spotsLeft:e.data.spotsLeft,auth:!0};t.go("form",o)}function n(e){console.log(e),401===e.status?alert("Sorry, that code is invalid, please check that you typed it correctly"):403===e.status?t.go("closed"):t.go("error")}r.code=r.code.trim().toLowerCase(),r.code=r.code.replace(/\s+/g,""),console.log(r.code);var a={method:"POST",url:"/api/validateCodes",header:{"Content-Type":"application/json"},data:{text:r.code}};e(a).then(o,n)}var r=this;r.code="",r.submit=o}angular.module("coderdojo-signup").controller("RegisterController",e),e.$inject=["$http","$state"]}(),angular.module("coderdojo-signup").controller("ViewController",["$scope","$http","$state",function(e,t,o){"use strict";e.ninjaCount=0,e.ninjas={},e.getNinjaCount=function(){return ninjaCount++,ninjaCount},t.get("/api/ninjaList").success(function(t){e.ninjas=t}).error(function(e){})}]),function(){function e(e,t){t.otherwise("/register"),e.state("register",{url:"/register",templateProvider:["$templateCache",function(e){return e.get("app/register/register.html")}],controller:"RegisterController",controllerAs:"vm"}).state("form",{url:"/form",params:{code:"",spotsLeft:0,auth:!1},templateProvider:["$templateCache",function(e){return e.get("app/form/form.html")}],controller:"FormController",controllerAs:"vm"}).state("accept",{url:"/accept",templateProvider:["$templateCache",function(e){return e.get("app/accept/accept.html")}],controller:"AcceptController",controllerAs:"vm"}).state("error",{url:"/error",templateProvider:["$templateCache",function(e){return e.get("app/error/error.html")}]}).state("closed",{url:"/closed",templateProvider:["$templateCache",function(e){return e.get("app/closed/closed.html")}]}).state("view",{url:"/view",templateProvider:["$templateCache",function(e){return e.get("app/view/view.html")}],controller:"ViewController"})}angular.module("coderdojo-signup").config(e),e.$inject=["$stateProvider","$urlRouterProvider"]}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImFjY2VwdC9hY2NlcHRDb250cm9sbGVyLmpzIiwiZm9ybS9mb3JtQ29udHJvbGxlci5qcyIsInJlZ2lzdGVyL3JlZ2lzdGVyQ29udHJvbGxlci5qcyIsInZpZXcvdmlld0NvbnRyb2xsZXIuanMiLCJjb21wb25lbnRzL2NvbmZpZy9jb25maWcuanMiXSwibmFtZXMiOlsiYW5ndWxhciIsIm1vZHVsZSIsIkFjY2VwdENvbnRyb2xsZXIiLCIkc2NvcGUiLCIkcm9vdFNjb3BlIiwiJHN0YXRlIiwiY29udHJvbGxlciIsIiRpbmplY3QiLCJGb3JtQ29udHJvbGxlciIsIiRodHRwIiwiYWRkIiwiY29uc29sZSIsImxvZyIsInZtIiwic3BvdHNMZWZ0IiwibmluamEiLCJmaXJzdE5hbWUiLCJsYXN0TmFtZSIsImJpcnRoZGF5IiwiRGF0ZSIsInVuZGVyMTIiLCJhY3Rpdml0aWVzIiwibmFtZSIsInNlbGVjdGVkIiwiZm9ybSIsIm5pbmphcyIsImxlbmd0aCIsImFsZXJ0IiwicHVzaCIsInJlbW92ZSIsImluZGV4IiwiaW5kZXhPZiIsInNwbGljZSIsImNhbGNVbmRlcjEyIiwiaXMxMiIsImRpZmYiLCJNYXRoIiwiYWJzIiwicmVnaXN0ZXIiLCJzdWNjZXNzIiwicmVzcG9uc2UiLCJnbyIsImVycm9yIiwiZXJyIiwiY29uZmlybSIsImkiLCJyZXEiLCJtZXRob2QiLCJ1cmwiLCJoZWFkZXIiLCJDb250ZW50LVR5cGUiLCJkYXRhIiwiY29kZSIsInRoZW4iLCJ0aGlzIiwiYXV0aCIsInBhcmFtcyIsImlzQnciLCJtaW5EYXRlIiwibWF4RGF0ZSIsImRvam8iLCJid0NvbnRhY3QiLCJwYXJlbnQiLCJlbWFpbCIsInBob25lIiwicGhvdG9QZXJtaXNzaW9uIiwiY29tbWVudHMiLCJSZWdpc3RlckNvbnRyb2xsZXIiLCJzdWJtaXQiLCJzdGF0dXMiLCJ0cmltIiwidG9Mb3dlckNhc2UiLCJyZXBsYWNlIiwidGV4dCIsIm5pbmphQ291bnQiLCJnZXROaW5qYUNvdW50IiwiZ2V0IiwiY29uZmlnIiwiJHN0YXRlUHJvdmlkZXIiLCIkdXJsUm91dGVyUHJvdmlkZXIiLCJvdGhlcndpc2UiLCJzdGF0ZSIsInRlbXBsYXRlUHJvdmlkZXIiLCIkdGVtcGxhdGVDYWNoZSIsImNvbnRyb2xsZXJBcyJdLCJtYXBwaW5ncyI6IkFBQUFBLFFBQUFDLE9BQUEsb0JBQUEsWUFBQSxlQUFBLHNCQ0FBLFdBV0EsUUFBQUMsR0FBQUMsRUFBQUMsRUFBQUMsSUFWQUwsUUFDQUMsT0FBQSxvQkFDQUssV0FBQSxtQkFBQUosR0FFQUEsRUFBQUssU0FDQSxTQUNBLGFBQ0EsYUNSQSxXQVVBLFFBQUFDLEdBQUFDLEVBQUFKLEdBeUNBLFFBQUFLLEtBQ0FDLFFBQUFDLElBQUEsUUFBQUMsRUFBQUMsVUFDQSxJQUFBQyxJQUNBQyxVQUFBLEdBQUFDLFNBQUEsR0FBQUMsU0FBQSxHQUFBQyxNQUFBLEtBQUEsRUFBQSxHQUFBQyxTQUFBLEVBQUFDLGFBQ0FDLEtBQUEsVUFBQUMsVUFBQSxJQUNBRCxLQUFBLGdCQUFBQyxVQUFBLElBQ0FELEtBQUEsd0JBQUFDLFVBQUEsSUFDQUQsS0FBQSxzQkFBQUMsVUFBQSxJQUNBRCxLQUFBLFFBQUFDLFVBQUEsSUFJQVYsR0FBQVcsS0FBQUMsT0FBQUMsUUFBQWIsRUFBQUMsVUFDQWEsTUFBQSxnQ0FBQWQsRUFBQUMsVUFBQSx3RUFBQUQsRUFBQUMsVUFDQSxnR0FHQUQsRUFBQVcsS0FBQUMsT0FBQUcsS0FBQWIsR0FJQSxRQUFBYyxHQUFBZCxHQUNBLEdBQUFlLEdBQUFqQixFQUFBVyxLQUFBQyxPQUFBTSxRQUFBaEIsRUFFQWUsSUFBQSxHQUNBakIsRUFBQVcsS0FBQUMsT0FBQU8sT0FBQUYsRUFBQSxHQUlBLFFBQUFHLEdBQUFsQixHQUNBLEdBQUFtQixHQUFBLEdBQUFmLE1BQUEsS0FBQSxFQUFBLEdBQ0FnQixFQUFBQyxLQUFBQyxJQUFBSCxFQUFBbkIsRUFBQUcsU0FFQSxPQUFBLEdBQUFpQixFQUdBLFFBQUFHLEtBb0JBLFFBQUFDLEdBQUFD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ImZpbGUiOiJjb2RlcmRvam8tc2lnbnVwLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXIubW9kdWxlKCdjb2RlcmRvam8tc2lnbnVwJywgWyd1aS5yb3V0ZXInLCAndWkuYm9vdHN0cmFwJywgJ3VpLmJvb3RzdHJhcC50cGxzJ10pOyIsIihmdW5jdGlvbigpIHtcbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2NvZGVyZG9qby1zaWdudXAnKVxuICAgICAgICAuY29udHJvbGxlcignQWNjZXB0Q29udHJvbGxlcicsIEFjY2VwdENvbnRyb2xsZXIpO1xuXG4gICAgQWNjZXB0Q29udHJvbGxlci4kaW5qZWN0ID0gW1xuICAgICAgICAnJHNjb3BlJyxcbiAgICAgICAgJyRyb290U2NvcGUnLFxuICAgICAgICAnJHN0YXRlJ1xuICAgIF07XG5cbiAgICBmdW5jdGlvbiBBY2NlcHRDb250cm9sbGVyKCRzY29wZSwgJHJvb3RTY29wZSwgJHN0YXRlKSB7XG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG5cblxuICAgIH1cbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnY29kZXJkb2pvLXNpZ251cCcpXG4gICAgICAgIC5jb250cm9sbGVyKCdGb3JtQ29udHJvbGxlcicsIEZvcm1Db250cm9sbGVyKTtcblxuICAgIEZvcm1Db250cm9sbGVyLiRpbmplY3QgPSBbXG4gICAgICAgICckaHR0cCcsXG4gICAgICAgICckc3RhdGUnXG4gICAgXTtcblxuICAgIGZ1bmN0aW9uIEZvcm1Db250cm9sbGVyKCRodHRwLCAkc3RhdGUpIHtcbiAgICAgICAgdmFyIHZtID0gdGhpcztcblxuICAgICAgICB2bS5hdXRoID0gJHN0YXRlLnBhcmFtcy5hdXRoO1xuICAgICAgICB2bS5jb2RlID0gJHN0YXRlLnBhcmFtcy5jb2RlO1xuICAgICAgICB2bS5pc0J3ID0gJHN0YXRlLnBhcmFtcy5jb2RlLmluZGV4T2YoJ2J3JykgPj0gMDtcbiAgICAgICAgdm0uc3BvdHNMZWZ0ID0gJHN0YXRlLnBhcmFtcy5zcG90c0xlZnQ7XG5cbiAgICAgICAgaWYgKCF2bS5hdXRoKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygndm0uYXV0aCBub3QgdHJ1ZScpO1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdyZWdpc3RlcicpO1xuICAgICAgICB9XG5cbiAgICAgICAgdm0ubWluRGF0ZSA9IG5ldyBEYXRlKDE5OTgsIDksIDUpO1xuICAgICAgICB2bS5tYXhEYXRlID0gbmV3IERhdGUoMjAwOCwgOSwgNSk7XG5cbiAgICAgICAgdm0uZm9ybSA9IHtcbiAgICAgICAgICAgIG5pbmphczogW1xuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgZmlyc3ROYW1lOiAnJywgbGFzdE5hbWU6ICcnLCBiaXJ0aGRheTogbmV3IERhdGUoMjAwOCwgOSwgNSksIHVuZGVyMTI6IGZhbHNlLCBhY3Rpdml0aWVzOiBbXG4gICAgICAgICAgICAgICAgICAgIHsgbmFtZTogJ1NjcmF0Y2gnLCBzZWxlY3RlZDogZmFsc2UgfSxcbiAgICAgICAgICAgICAgICAgICAgeyBuYW1lOiAnRWRpc29uIFJvYm90cycsIHNlbGVjdGVkOiBmYWxzZSB9LFxuICAgICAgICAgICAgICAgICAgICB7IG5hbWU6ICdMRUdPIE1pbmRzdG9ybSBSb2JvdHMnLCBzZWxlY3RlZDogZmFsc2UgfSxcbiAgICAgICAgICAgICAgICAgICAgeyBuYW1lOiAnV2Vic2l0ZSBEZXZlbG9wbWVudCcsIHNlbGVjdGVkOiBmYWxzZSB9LFxuICAgICAgICAgICAgICAgICAgICB7IG5hbWU6ICdPdGhlcicsIHNlbGVjdGVkOiBmYWxzZSB9XG4gICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgICBkb2pvOiB2bS5pc0J3ID8gJ0Jhbmt3ZXN0JyA6ICcnLFxuICAgICAgICAgICAgYndDb250YWN0OiB7IGZpcnN0TmFtZTogJycsIGxhc3ROYW1lOiAnJ30sXG4gICAgICAgICAgICBwYXJlbnQ6IHtcbiAgICAgICAgICAgICAgICBmaXJzdE5hbWU6ICcnLCBsYXN0TmFtZTogJycsIGVtYWlsOiAnJywgcGhvbmU6ICcnXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcGhvdG9QZXJtaXNzaW9uOiBmYWxzZSxcbiAgICAgICAgICAgIGNvbW1lbnRzOiAnJ1xuICAgICAgICB9O1xuXG4gICAgICAgIHZtLmFkZCA9IGFkZDtcbiAgICAgICAgdm0ucmVtb3ZlID0gcmVtb3ZlO1xuICAgICAgICB2bS5yZWdpc3RlciA9IHJlZ2lzdGVyO1xuXG4gICAgICAgIGZ1bmN0aW9uIGFkZCgpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdTcG90cycsIHZtLnNwb3RzTGVmdCk7XG4gICAgICAgICAgICB2YXIgbmluamEgPSB7XG4gICAgICAgICAgICAgICAgZmlyc3ROYW1lOiAnJywgbGFzdE5hbWU6ICcnLCBiaXJ0aGRheTogbmV3IERhdGUoMjAwOCwgOSwgNSksIHVuZGVyMTI6IGZhbHNlLCBhY3Rpdml0aWVzOiBbXG4gICAgICAgICAgICAgICAgICAgIHsgbmFtZTogJ1NjcmF0Y2gnLCBzZWxlY3RlZDogZmFsc2UgfSxcbiAgICAgICAgICAgICAgICAgICAgeyBuYW1lOiAnRWRpc29uIFJvYm90cycsIHNlbGVjdGVkOiBmYWxzZSB9LFxuICAgICAgICAgICAgICAgICAgICB7IG5hbWU6ICdMRUdPIE1pbmRzdG9ybSBSb2JvdHMnLCBzZWxlY3RlZDogZmFsc2UgfSxcbiAgICAgICAgICAgICAgICAgICAgeyBuYW1lOiAnV2Vic2l0ZSBEZXZlbG9wbWVudCcsIHNlbGVjdGVkOiBmYWxzZSB9LFxuICAgICAgICAgICAgICAgICAgICB7IG5hbWU6ICdPdGhlcicsIHNlbGVjdGVkOiBmYWxzZSB9XG4gICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgaWYgKHZtLmZvcm0ubmluamFzLmxlbmd0aCA+PSB2bS5zcG90c0xlZnQpIHtcbiAgICAgICAgICAgICAgICBhbGVydCgnVW5mb3J0dW5hdGVseSB0aGVyZSBhcmUgb25seSAnICsgdm0uc3BvdHNMZWZ0ICsgJyBzcG90cyBsZWZ0IGZvciB0aGlzIGV2ZW50LiBUaGVyZWZvcmUsIHlvdSBjYW5ub3QgcmVnaXN0ZXIgbW9yZSB0aGFuICcgKyB2bS5zcG90c0xlZnQgK1xuICAgICAgICAgICAgICAgICAgICAnIG5pbmphcyBhdCB0aGlzIHRpbWUuIFBsZWFzZSBjb250YWN0IHlvdXIgbG9jYWwgQ29kZXJEb2pvIGNoYW1waW9uIGlmIHlvdSBoYXZlIGFueSBxdWVzdGlvbnMnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHZtLmZvcm0ubmluamFzLnB1c2gobmluamEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gcmVtb3ZlKG5pbmphKSB7XG4gICAgICAgICAgICB2YXIgaW5kZXggPSB2bS5mb3JtLm5pbmphcy5pbmRleE9mKG5pbmphKTtcblxuICAgICAgICAgICAgaWYgKGluZGV4ID49IDApIHtcbiAgICAgICAgICAgICAgICB2bS5mb3JtLm5pbmphcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gY2FsY1VuZGVyMTIobmluamEpIHtcbiAgICAgICAgICAgIHZhciBpczEyID0gbmV3IERhdGUgKDIwMDMsIDksIDUpO1xuICAgICAgICAgICAgdmFyIGRpZmYgPSBNYXRoLmFicyhpczEyIC0gbmluamEuYmlydGhkYXkpO1xuXG4gICAgICAgICAgICByZXR1cm4gZGlmZiA8IDA7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiByZWdpc3RlcigpIHtcbiAgICAgICAgICAgIGlmIChjb25maXJtKCdJcyBhbGwgdGhlIGluZm9ybWF0aW9uIGNvcnJlY3Q/IFlvdSB3aWxsIG5vdCBiZSBhYmxlIHRvIGdvIGJhY2sgYW5kIGVkaXQgaXQuJykpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyh2bS5mb3JtKTtcblxuICAgICAgICAgICAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCB2bS5mb3JtLm5pbmphcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICB2bS5mb3JtLm5pbmphc1tpXS51bmRlcjEyID0gY2FsY1VuZGVyMTIodm0uZm9ybS5uaW5qYXNbaV0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciByZXEgPSB7XG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgICAgICAgICB1cmw6ICcvYXBpL3JlZ2lzdGVyTmluamEnLFxuICAgICAgICAgICAgICAgICAgICBoZWFkZXI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge2Zvcm06IHZtLmZvcm0sIGNvZGU6IHZtLmNvZGV9XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICRodHRwKHJlcSlcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oc3VjY2VzcywgZXJyb3IpO1xuXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gc3VjY2VzcyhyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnc3VibWl0IGZvcm0gc3VjY2VzcycsIHJlc3BvbnNlKTtcbiAgICAgICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdhY2NlcHQnKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBlcnJvcihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3N1Ym1pdCBmb3JtIGVycicsIGVycik7XG4gICAgICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnZXJyb3InKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdjb2RlcmRvam8tc2lnbnVwJylcbiAgICAgICAgLmNvbnRyb2xsZXIoJ1JlZ2lzdGVyQ29udHJvbGxlcicsIFJlZ2lzdGVyQ29udHJvbGxlcik7XG5cbiAgICBSZWdpc3RlckNvbnRyb2xsZXIuJGluamVjdCA9IFtcbiAgICAgICAgJyRodHRwJyxcbiAgICAgICAgJyRzdGF0ZSdcbiAgICBdO1xuXG4gICAgZnVuY3Rpb24gUmVnaXN0ZXJDb250cm9sbGVyKCRodHRwLCAkc3RhdGUpIHtcbiAgICAgICAgdmFyIHZtID0gdGhpcztcblxuICAgICAgICB2bS5jb2RlID0gJyc7XG5cbiAgICAgICAgdm0uc3VibWl0ID0gc3VibWl0O1xuXG4gICAgICAgIGZ1bmN0aW9uIHN1Ym1pdCgpIHtcbiAgICAgICAgICAgIHZtLmNvZGUgPSB2bS5jb2RlLnRyaW0oKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgdm0uY29kZSA9IHZtLmNvZGUucmVwbGFjZSgvXFxzKy9nLCAnJyk7XG5cbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHZtLmNvZGUpO1xuXG4gICAgICAgICAgICB2YXIgcmVxID0ge1xuICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgICAgIHVybDogJy9hcGkvdmFsaWRhdGVDb2RlcycsXG4gICAgICAgICAgICAgICAgaGVhZGVyOiB7XG4gICAgICAgICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGRhdGE6IHt0ZXh0OiB2bS5jb2RlfVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgJGh0dHAocmVxKVxuICAgICAgICAgICAgICAgIC50aGVuKHN1Y2Nlc3MsIGVycm9yKTtcblxuICAgICAgICAgICAgZnVuY3Rpb24gc3VjY2VzcyhyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTtcblxuICAgICAgICAgICAgICAgIHZhciBkYXRhID0ge2NvZGU6IHJlc3BvbnNlLmRhdGEuY29kZSwgc3BvdHNMZWZ0OiByZXNwb25zZS5kYXRhLnNwb3RzTGVmdCwgYXV0aDogdHJ1ZX07XG4gICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdmb3JtJywgZGF0YSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGVycm9yKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuXG4gICAgICAgICAgICAgICAgaWYgKGVycm9yLnN0YXR1cyA9PT0gNDAxKSB7XG4gICAgICAgICAgICAgICAgICAgIGFsZXJ0KCdTb3JyeSwgdGhhdCBjb2RlIGlzIGludmFsaWQsIHBsZWFzZSBjaGVjayB0aGF0IHlvdSB0eXBlZCBpdCBjb3JyZWN0bHknKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoZXJyb3Iuc3RhdHVzID09PSA0MDMpIHtcbiAgICAgICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdjbG9zZWQnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnZXJyb3InKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfVxuICAgIH1cbn0pKCk7XG4iLCIvLyBUT0RPOiB1cGRhdGUgdGhpc1xuYW5ndWxhci5tb2R1bGUoJ2NvZGVyZG9qby1zaWdudXAnKVxuLmNvbnRyb2xsZXIoJ1ZpZXdDb250cm9sbGVyJywgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCwgJHN0YXRlKSB7XG5cdCd1c2Ugc3RyaWN0Jztcblx0JHNjb3BlLm5pbmphQ291bnQgPSAwO1xuXG5cdCRzY29wZS5uaW5qYXMgPSB7fTtcblxuXHQkc2NvcGUuZ2V0TmluamFDb3VudCA9IGZ1bmN0aW9uKCkge1xuXHRcdG5pbmphQ291bnQrKztcblx0XHRyZXR1cm4gbmluamFDb3VudDtcblx0fTtcblxuXHQkaHR0cC5nZXQoJy9hcGkvbmluamFMaXN0Jylcblx0LnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xuXHRcdCRzY29wZS5uaW5qYXMgPSBkYXRhO1xuXHR9KVxuXHQuZXJyb3IoZnVuY3Rpb24oZGF0YSkge1xuXG5cdH0pO1xufSk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2NvZGVyZG9qby1zaWdudXAnKVxuICAgICAgICAuY29uZmlnKGNvbmZpZyk7XG5cbiAgICBjb25maWcuJGluamVjdCA9IFtcbiAgICAgICAgJyRzdGF0ZVByb3ZpZGVyJyxcbiAgICAgICAgJyR1cmxSb3V0ZXJQcm92aWRlcidcbiAgICBdO1xuXG4gICAgZnVuY3Rpb24gY29uZmlnKCRzdGF0ZVByb3ZpZGVyLCAkdXJsUm91dGVyUHJvdmlkZXIpIHtcbiAgICAgICAgJHVybFJvdXRlclByb3ZpZGVyLm90aGVyd2lzZSgnL3JlZ2lzdGVyJyk7XG5cbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgncmVnaXN0ZXInLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL3JlZ2lzdGVyJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVByb3ZpZGVyOiBmdW5jdGlvbiAoJHRlbXBsYXRlQ2FjaGUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICR0ZW1wbGF0ZUNhY2hlLmdldCgnYXBwL3JlZ2lzdGVyL3JlZ2lzdGVyLmh0bWwnKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdSZWdpc3RlckNvbnRyb2xsZXInLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJ1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnZm9ybScsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvZm9ybScsXG4gICAgICAgICAgICAgICAgcGFyYW1zOiB7XG4gICAgICAgICAgICAgICAgICAgIGNvZGU6ICcnLFxuICAgICAgICAgICAgICAgICAgICBzcG90c0xlZnQ6IDAsXG4gICAgICAgICAgICAgICAgICAgIGF1dGg6IGZhbHNlXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVByb3ZpZGVyOiBmdW5jdGlvbiAoJHRlbXBsYXRlQ2FjaGUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICR0ZW1wbGF0ZUNhY2hlLmdldCgnYXBwL2Zvcm0vZm9ybS5odG1sJyk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnRm9ybUNvbnRyb2xsZXInLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJ1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnYWNjZXB0Jywge1xuICAgICAgICAgICAgICAgIHVybDogJy9hY2NlcHQnLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlUHJvdmlkZXI6IGZ1bmN0aW9uICgkdGVtcGxhdGVDYWNoZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHRlbXBsYXRlQ2FjaGUuZ2V0KCdhcHAvYWNjZXB0L2FjY2VwdC5odG1sJyk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnQWNjZXB0Q29udHJvbGxlcicsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlckFzOiAndm0nXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdlcnJvcicsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvZXJyb3InLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlUHJvdmlkZXI6IGZ1bmN0aW9uICgkdGVtcGxhdGVDYWNoZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHRlbXBsYXRlQ2FjaGUuZ2V0KCdhcHAvZXJyb3IvZXJyb3IuaHRtbCcpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2Nsb3NlZCcsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvY2xvc2VkJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVByb3ZpZGVyOiBmdW5jdGlvbiAoJHRlbXBsYXRlQ2FjaGUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICR0ZW1wbGF0ZUNhY2hlLmdldCgnYXBwL2Nsb3NlZC9jbG9zZWQuaHRtbCcpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ3ZpZXcnLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL3ZpZXcnLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlUHJvdmlkZXI6IGZ1bmN0aW9uICgkdGVtcGxhdGVDYWNoZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHRlbXBsYXRlQ2FjaGUuZ2V0KCdhcHAvdmlldy92aWV3Lmh0bWwnKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdWaWV3Q29udHJvbGxlcidcbiAgICAgICAgICAgIH0pO1xuICAgIH1cbn0pKCk7XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=